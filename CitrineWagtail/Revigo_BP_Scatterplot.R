# A plotting R script produced by the Revigo server at http://revigo.irb.hr/
# If you found Revigo useful in your work, please cite the following reference:
# Supek F et al. "REVIGO summarizes and visualizes long lists of Gene Ontology
# terms" PLoS ONE 2011. doi:10.1371/journal.pone.0021800

# --------------------------------------------------------------------------
# If you don't have the ggplot2 package installed, uncomment the following line:
# install.packages( "ggplot2" );
library( ggplot2 );

# --------------------------------------------------------------------------
# If you don't have the scales package installed, uncomment the following line:
# install.packages( "scales" );
library( scales );

# --------------------------------------------------------------------------
# Here is your data from Revigo. Scroll down for plot configuration options.

revigo.names <- c("term_ID","description","frequency","plot_X","plot_Y","log_size","uniqueness","dispensability");
revigo.data <- rbind(c("GO:0001101","response to acid chemical",0.16387317945664703,2.4086860051491135,-6.452540112161315,4.822743269302308,0.9423079889510152,0.34695647),
c("GO:0001501","skeletal system development",0.13053263922306657,-5.6912282133683885,1.4406347430474025,4.723956176778731,0.8353025923086497,0.54007801),
c("GO:0001558","regulation of cell growth",0.15345225803226778,7.729751824965222,2.2724950957994987,4.794209116346496,0.8025021430979351,0.15250965),
c("GO:0001894","tissue homeostasis",0.05029795257977945,-5.415181698179855,2.6591483900170982,4.309800445601733,0.893335444488437,0.528264),
c("GO:0006082","organic acid metabolic process",9.010158377301833,-4.624481542910912,-3.750432652701828,6.562961401103923,0.9362338870233056,0.45739014),
c("GO:0006107","oxaloacetate metabolic process",0.06228398400994887,-5.665621308427235,-2.5365653379515196,4.402622427748527,0.9557983796692853,-0),
c("GO:0006508","proteolysis",5.2622572267907,-2.935052720181483,-3.404754686340437,6.329401134014754,0.9501429937314386,0.52839667),
c("GO:0006520","amino acid metabolic process",5.369313215926915,-0.9594352066812225,-4.62962832369543,6.338147795775586,0.9732436833306062,0.13861317),
c("GO:0006528","asparagine metabolic process",0.08604900869629344,-4.998277040105035,-2.8995186496931056,4.542987168420798,0.9411179901692431,0.30970771),
c("GO:0006541","glutamine metabolic process",0.5478057552077248,-4.773126732205938,-3.1117483202537315,5.346857402008173,0.9297967698222884,0.56948172),
c("GO:0006807","nitrogen compound metabolic process",40.19370343674496,-1.7732337816895716,-6.104250629926559,7.212386907825831,0.969021964330142,0.17023419),
c("GO:0006810","transport",18.530066921639108,-0.12333916360893832,6.6123764097367035,6.876105902934969,0.8934109876080824,0.57608784),
c("GO:0007154","cell communication",9.671968224175414,5.804633303694437,6.719512585485462,6.593743829102137,0.9917670706314001,0.01247242),
c("GO:0007267","cell-cell signaling",0.8164648981071486,6.6188445826909215,2.1713134813759094,5.5201676864837,0.8391990370728911,0.2017425),
c("GO:0007417","central nervous system development",0.3186292850370455,-5.670143366032692,1.5674127791128354,5.11151790589336,0.8119581054253289,0.59980561),
c("GO:0008150","biological_process",100,3.0529059407077375,7.811651926387628,7.608228868089044,1,-0),
c("GO:0008152","metabolic process",57.597931274565454,5.13191210107101,6.906442749990225,7.368635761264388,1,-0),
c("GO:0009410","response to xenobiotic stimulus",0.16588440743259156,2.352858812604778,-6.80812771958099,4.828040875907554,0.9422561006651774,0.44915338),
c("GO:0009719","response to endogenous stimulus",1.0360338111084262,1.5921105599818812,-6.800430004300848,5.6236038194784435,0.9636852967809203,-0),
c("GO:0009743","response to carbohydrate",0.08030616410811849,2.927406751468321,-6.726296872159097,4.512991068415215,0.9311884193822372,0.45574247),
c("GO:0009749","response to glucose",0.058823488816044316,2.9379718320851924,-6.52834522608988,4.3777978331112255,0.9266467857206364,0.60852813),
c("GO:0009892","negative regulation of metabolic process",2.967428853056825,5.505250869259522,0.5877343510942583,6.080609533234876,0.7232414176381508,0.42732588),
c("GO:0009894","regulation of catabolic process",0.903102979703259,7.144244862110462,0.8015680995129645,5.563967317849402,0.826173607102365,0.20667975),
c("GO:0009914","hormone transport",0.04479665252793118,2.708039129520065,4.223551213459396,4.259498314030925,0.817031340896331,0.18999525),
c("GO:0009987","cellular process",78.37474688350859,-4.6360634902734725,5.239625600769732,7.502405022300505,1,-0),
c("GO:0010033","response to organic substance",1.803573616908591,2.452035329609233,-6.6645057010724855,5.864363324606595,0.9301230050977792,0.67736275),
c("GO:0010817","regulation of hormone levels",0.49112166085628817,5.017379611348812,2.6972435633214875,5.299420125982029,0.8432697566812104,0.61023808),
c("GO:0014070","response to organic cyclic compound",0.22379594238699438,2.7978298572304086,-6.627811251434785,4.958085848521085,0.9287628838353013,0.59609933),
c("GO:0015833","peptide transport",0.6001346536847817,-0.0700680777802493,6.026708001129207,5.386479346054928,0.9116380060855656,0.23440443),
c("GO:0016043","cellular component organization",12.33090773324058,-1.8027188716996942,0.6962768821961961,6.699223992323687,0.9317951315328278,0.51519037),
c("GO:0016192","vesicle-mediated transport",2.6087919056355493,0.004759079482230713,7.001601611127683,6.024668706001865,0.9130682075745116,0.32516076),
c("GO:0016202","regulation of striated muscle tissue development",0.0017228533764524837,6.691875735076633,-3.9269295220034897,2.845098040014257,0.8062102273357818,0.38229553),
c("GO:0016358","dendrite development",0.04044638613388449,-4.595570580967922,1.3431063960264475,4.215135045480261,0.7961971305063057,0.69218654),
c("GO:0016579","protein deubiquitination",0.0016070105886223452,-2.286933167377498,2.4927410031680153,2.814913181275074,0.962995208038886,0.37098863),
c("GO:0019222","regulation of metabolic process",15.404248935996318,6.200808862445866,0.33802526694046464,6.795869455173839,0.7931247204444737,0.45007165),
c("GO:0019538","protein metabolic process",14.600987650961638,-3.0098136896882535,-4.149121028846466,6.772611164347735,0.9484855192592089,0.36322538),
c("GO:0021953","central nervous system neuron differentiation",0.03551937054085371,-5.611778625563325,1.6896452073219232,4.158724253450531,0.8258470176071735,0.62411433),
c("GO:0021954","central nervous system neuron development",0.01685389325920184,-5.690169610850878,1.7537633915881676,3.83499260373303,0.8285658520355896,0.68913639),
c("GO:0023052","signaling",9.097212999986098,5.910132607950491,0.23330734470903156,6.567137338347482,0.8066223912725153,0.35580688),
c("GO:0030030","cell projection organization",1.3282977705833654,-1.6520913352316255,0.8869662944415515,5.731525106970354,0.9402368741469033,0.41569968),
c("GO:0030162","regulation of proteolysis",0.31614975642944726,7.536272745043215,1.0433211675858134,5.108125094738599,0.8157625609429735,0.30244968),
c("GO:0031016","pancreas development",0.021618236001237103,-5.930071636826175,0.6493291210909757,3.9430986230054854,0.8792496176646845,-0),
c("GO:0031329","regulation of cellular catabolic process",0.587579267276128,7.3385215950442495,0.3945630444960278,5.377297142447473,0.80101966839008,0.32149242),
c("GO:0032501","multicellular organismal process",4.184729514977585,4.56474397778007,7.278302574832862,6.229896505267957,1,-0),
c("GO:0032502","developmental process",4.156005433076044,-5.067361132881451,4.704022603199637,6.2269052215766765,1,-0),
c("GO:0032507","maintenance of protein location in cell",0.09837517426945347,-1.053604357142071,6.796073781945962,4.601125252987698,0.8996813369067904,0.20157183),
c("GO:0032535","regulation of cellular component size",0.37275744383571935,2.9687985542909154,1.4667317594971008,5.179658053930065,0.7975241141509509,0.49206877),
c("GO:0032787","monocarboxylic acid metabolic process",3.6701164155934447,-5.1298673087825,-3.2852980301510417,6.172908989276335,0.9313030157462804,0.58455158),
c("GO:0032879","regulation of localization",0.8977569582819065,7.276873770572822,1.5945821373127065,5.5613888296290535,0.848807978647044,0.17739051),
c("GO:0032940","secretion by cell",0.7673426265868367,0.3967135504714459,7.087113450081529,5.4932195766843535,0.8985384981625334,0.27507165),
c("GO:0032989","cellular anatomical entity morphogenesis",0.5334190668552883,-5.801009538572827,0.7963370645690535,5.335299399418015,0.835927488951757,0.46905436),
c("GO:0033036","macromolecule localization",5.437478069974368,-0.2229225430917886,6.8445712030438015,6.343626572647517,0.912363226969819,0.39682233),
c("GO:0033365","protein localization to organelle",1.527857922912195,-0.6525243087310121,6.765976368365293,5.792312528612478,0.8844226108037319,0.55108268),
c("GO:0034641","cellular nitrogen compound metabolic process",24.77172315999013,-3.4252230536362425,-4.807462135146099,7.002185118439548,0.9485423243748731,0.40483001),
c("GO:0036211","protein modification process",3.782609621537176,-2.8938068713894567,-3.0065496323253886,6.186020663275152,0.9455722917257484,0.06231924),
c("GO:0040008","regulation of growth",0.2209540969749061,7.05801804833765,2.8962797955057122,4.952535760655082,0.8660384266521416,0.09915829),
c("GO:0042221","response to chemical",4.8560360057130705,1.8285446001813734,-6.71415662591209,6.2945109760284925,0.9582073844603887,0.37752063),
c("GO:0042592","homeostatic process",2.0950365358293856,3.759321404495665,7.633161252534957,5.9294209694482225,1,0),
c("GO:0042886","amide transport",0.7045361176615689,-0.3187817407385604,6.075589268838626,5.456133638599328,0.9182406581889485,0.52431469),
c("GO:0042981","regulation of apoptotic process",0.6083841390223874,7.578736086533302,-0.23892142450839823,5.392408500017495,0.839729503017485,0.19569592),
c("GO:0043067","regulation of programmed cell death",0.627229542336201,7.259194986160094,-0.600459686189396,5.405657069277359,0.850470891172998,0.20235982),
c("GO:0043170","macromolecule metabolic process",29.459939937239827,-2.2776055221709224,-5.226289030318497,7.077460750790044,0.9648619405899723,0.21927763),
c("GO:0043412","macromolecule modification",5.943809642398736,-1.7845208707555384,-3.482169693106405,6.382293929651042,0.966862853729222,0.28276727),
c("GO:0043603","amide metabolic process",6.707376287050344,-3.7337600591868627,-5.260444114697084,6.434781688128081,0.96916619742228,0.18241126),
c("GO:0043648","dicarboxylic acid metabolic process",1.2968131796952338,-5.445668923772782,-2.890769690117848,5.721107098468782,0.9398403507732123,0.39216305),
c("GO:0044057","regulation of system process",0.16157604162137706,6.372552131879535,3.395381565984152,4.816612446562207,0.7968169547048123,0.15313689),
c("GO:0044237","cellular metabolic process",46.10331480933213,-2.391528623005133,-6.034812181869388,7.271961032709232,0.9594770276920103,0.32262346),
c("GO:0044238","primary metabolic process",45.47569830278978,-2.1158945434967547,-6.110618004465816,7.2660082575255345,0.9677475487603475,0.27529491),
c("GO:0044281","small molecule metabolic process",15.932395923635251,-1.22559624443965,-6.8124161809608115,6.810510014757425,0.9761035238482006,0.09152771),
c("GO:0045595","regulation of cell differentiation",0.4296411821406505,6.700659152831902,-1.7936881640187943,5.241337251669941,0.7548886585512967,0.56471038),
c("GO:0045861","negative regulation of proteolysis",0.03659399725349074,4.248303381809622,1.3588090365001972,4.171667958874787,0.7735580805464007,0.55727404),
c("GO:0046903","secretion",0.8219612686786636,0.6020551555808417,6.825101920537459,5.523081513460701,0.9278520756438289,0.28401786),
c("GO:0046907","intracellular transport",2.9683457363987995,-0.4941261929202145,6.662235044187398,6.080743701755747,0.878402660054487,0.69228996),
c("GO:0048193","Golgi vesicle transport",0.842896771653753,0.5397544447264346,6.468991978565003,5.534004517782176,0.9201881750595889,0.32613176),
c("GO:0048513","animal organ development",1.1634559482412452,-5.854547021662436,0.8909255499623052,5.673979721728252,0.8357470584961411,0.66203394),
c("GO:0048518","positive regulation of biological process",4.759580864033397,6.14430189255196,-0.08252429832591231,6.285797792051727,0.8208235639807839,0.28486907),
c("GO:0048519","negative regulation of biological process",4.972803071105683,6.545143198878981,0.12257478147541818,6.30483033363687,0.8199346649136545,0.31768462),
c("GO:0048583","regulation of response to stimulus",2.4780965935614874,6.108178946981353,1.2448090479902822,6.002347520043884,0.8330182914044585,0.25677296),
c("GO:0048634","regulation of muscle organ development",0.0023809390009343337,6.784107245596859,-3.7290535143976586,2.9854264740830017,0.8234473486869255,0.1146025),
c("GO:0048871","multicellular organismal-level homeostasis",0.1190321616057171,-5.491285894343622,2.5599430280077398,4.683902170403431,0.8967491158873379,-0),
c("GO:0050789","regulation of biological process",26.88618924255281,6.028180315787375,0.6321232130032883,7.037758148353473,0.7867232857232178,0.67620211),
c("GO:0050793","regulation of developmental process",1.507417832710592,6.645005997453544,1.5444786669557895,5.786463216145656,0.8411701287126592,0.21873794),
c("GO:0050794","regulation of cellular process",25.237088286105465,6.072084088013418,0.4420074564946566,7.010268146797013,0.7785338119242232,0.59148681),
c("GO:0050808","synapse organization",0.22122768313339855,-1.6499032425584141,0.3721169318862119,4.953073167011008,0.9364384978407564,0.00780942),
c("GO:0050896","response to stimulus",17.567785530535815,-3.655510401176443,6.268421595768073,6.852945939203233,1,-0),
c("GO:0051128","regulation of cellular component organization",1.6291932501217334,6.559681218948622,-0.5059582667122433,5.820202116511591,0.836527954686096,0.2310896),
c("GO:0051147","regulation of muscle cell differentiation",0.026801584571594147,6.9171615870842,-2.624299900654611,4.036429265626675,0.7841585478935678,0.60427183),
c("GO:0051153","regulation of striated muscle cell differentiation",0.01946651783579645,6.883134736258772,-2.7781049034235643,3.8975721138257304,0.7777548849806952,0.64722509),
c("GO:0051171","regulation of nitrogen compound metabolic process",13.768610390338928,6.234904769496383,0.6568133951505013,6.747119046027346,0.7655094646741207,0.57538669),
c("GO:0051179","localization",19.75810399172557,3.797610123685602,6.8446983056021,6.903974178460681,1,-0),
c("GO:0051235","maintenance of location",0.2512506831027372,-0.9800329976168973,6.212372206157613,5.0083403689366985,0.9378829556434859,-0),
c("GO:0051239","regulation of multicellular organismal process",1.0189087964308985,5.995420597702241,2.0604792083365067,5.616365219544435,0.8470157829712722,0.2065478),
c("GO:0051246","regulation of protein metabolic process",2.0475656402206948,6.675296446908874,0.808449250067205,5.9194672132955555,0.8095428998574749,0.36818485),
c("GO:0051248","negative regulation of protein metabolic process",0.3529088912741001,4.990512606557018,0.8740456950110077,5.15589449073765,0.7481328996777692,0.66802713),
c("GO:0051641","cellular localization",5.891744471119505,0.08035374722159185,6.751360544946479,6.37847294200483,0.9062098092356246,0.45310835),
c("GO:0060348","bone development",0.03470107680554294,-5.833103347255736,1.429259524676779,4.148602654806093,0.8491816265580486,0.53664272),
c("GO:0060996","dendritic spine development",0.007162534924135791,-4.629819597693522,1.2636608987021636,3.4634450317704277,0.8133046044261268,0.60690842),
c("GO:0065007","biological regulation",28.180269025403287,-4.088396770405639,5.748244839948656,7.058174030193043,1,-0),
c("GO:0065008","regulation of biological quality",3.3795629857941245,5.695449998707445,1.4246759656260624,6.137089719032985,0.8355179345018823,0.24242264),
c("GO:0071108","protein K48-linked deubiquitination",0.0002045734338276912,-2.379205074161165,2.8946692053234138,1.9242792860618816,0.9643785215678269,0.60878584),
c("GO:0071702","organic substance transport",8.155300221619576,-0.07806113438554915,6.478725072992051,6.519668942022452,0.9044959703527738,0.63961773),
c("GO:0071704","organic substance metabolic process",50.871943734517124,-2.119607652222453,-5.814373994300133,7.314707210062957,0.9665204308987592,0.31960258),
c("GO:0071705","nitrogen compound transport",6.023736236521199,0.1419037831694413,6.509457602491164,6.3880949820878214,0.9084076833228641,0.59651016),
c("GO:0071840","cellular component organization or biogenesis",14.483683272212708,-3.671612918833369,4.823101570327898,6.7691079504292695,0.9912304205544329,0.02469206),
c("GO:0080134","regulation of response to stress",0.5340401813772712,5.219190883329397,-0.6949103679886731,5.335804796499437,0.8273425286178221,0.19313132),
c("GO:0080135","regulation of cellular response to stress",0.22314771572317893,5.171140323074939,-1.086632360097032,4.956826099778944,0.830067480005502,0.63612485),
c("GO:0090066","regulation of anatomical structure size",0.4469214754486739,4.863435189850478,2.6683936344157075,5.258462476340173,0.8444934173640087,0.59494328),
c("GO:0090087","regulation of peptide transport",0.054261254767670145,3.222843463367148,-0.5664680295398449,4.3427384165554175,0.8441534809240965,0.47771453),
c("GO:0090257","regulation of muscle system process",0.06272024301943684,6.418712722855068,3.8065411289950357,4.405653656099307,0.7999922067124879,0.65782402),
c("GO:0097066","response to thyroid hormone",0.003805558817228376,3.188284412417283,-6.623085403230686,3.1889284837608534,0.9439689347496552,0.32218911),
c("GO:0097068","response to thyroxine",5.175954349857247E-05,3.5248030102805874,-6.659045343061543,1.3424226808222062,0.9499234272862568,0.39876883),
c("GO:0106027","neuron projection organization",0.013156783009303803,-2.4683911451691816,0.5476357083123877,3.7274599208579087,0.921580385981211,0.63436089),
c("GO:0120036","plasma membrane bounded cell projection organization",1.1030821378604103,-2.221023211110789,0.6909218997100706,5.650837679918879,0.8952394316905984,0.34554246),
c("GO:1901564","organonitrogen compound metabolic process",27.31959408292786,-2.984838103676602,-4.876598394030973,7.044703138835916,0.9551192614077725,0.27258733),
c("GO:1901605","alpha-amino acid metabolic process",3.911133497524464,-4.376660552587437,-3.429219297423782,6.20053177091683,0.9154148563215171,0.68312599),
c("GO:1901698","response to nitrogen compound",0.6170008706448165,2.557069540868912,-6.801388268103765,5.398516369125313,0.9360993430484801,0.5009805),
c("GO:1901700","response to oxygen-containing compound",1.1305960323401514,2.547308822201263,-6.590612524877366,5.661537261195842,0.932838365409516,0.60144425),
c("GO:1901861","regulation of muscle tissue development",0.01028289597504973,6.856571925824578,-3.1041188878512025,3.620448384711709,0.808804502555162,0.42000583),
c("GO:1903573","negative regulation of response to endoplasmic reticulum stress",0.009506502822571143,4.176803404385897,-1.3972668842008535,3.586362223307866,0.8009687747638037,0.67740428),
c("GO:1904386","response to L-phenylalanine derivative",6.161850416496723E-05,3.593838981126277,-6.500013648734262,1.414973347970818,0.9530565300243976,0.15194703),
c("GO:1904589","regulation of protein import",0.0001774612919951056,1.2576714102419149,-2.1779362646320273,1.863322860120456,0.8788330767195834,0.51382663),
c("GO:1904591","positive regulation of protein import",0.00017499655182850692,1.3997927988403858,-2.435965138454194,1.8573324964312685,0.8784747649313009,-0),
c("GO:1905207","regulation of cardiocyte differentiation",0.0027777621677567226,6.937905704120899,-3.499997880980254,3.0523090996473234,0.8097067568658968,0.39093494));

one.data <- data.frame(revigo.data);
names(one.data) <- revigo.names;
one.data <- one.data [(one.data$plot_X != "null" & one.data$plot_Y != "null"), ];
one.data$plot_X <- as.numeric( as.character(one.data$plot_X) );
one.data$plot_Y <- as.numeric( as.character(one.data$plot_Y) );
one.data$log_size <- as.numeric( as.character(one.data$log_size) );
one.data$frequency <- as.numeric( as.character(one.data$frequency) );
one.data$uniqueness <- as.numeric( as.character(one.data$uniqueness) );
one.data$dispensability <- as.numeric( as.character(one.data$dispensability) );
#head(one.data);


# --------------------------------------------------------------------------
# Names of the axes, sizes of the numbers and letters, names of the columns,
# etc. can be changed below

p1 <- ggplot( data = one.data );
p1 <- p1 + geom_point( aes( plot_X, plot_Y, colour = uniqueness, size = log_size), alpha = I(0.6) );
p1 <- p1 + scale_colour_gradientn( colours = c("blue", "green", "yellow", "red"), limits = c( min(one.data$uniqueness), 0) );
p1 <- p1 + geom_point( aes(plot_X, plot_Y, size = log_size), shape = 21, fill = "transparent", colour = I (alpha ("black", 0.6) ));
p1 <- p1 + scale_size( range=c(5, 30)) + theme_bw(); # + scale_fill_gradientn(colours = heat_hcl(7), limits = c(-300, 0) );
ex <- one.data [ one.data$dispensability < 0.15, ];
p1 <- p1 + geom_text( data = ex, aes(plot_X, plot_Y, label = description), colour = I(alpha("black", 0.85)), size = 3 );
p1 <- p1 + labs (y = "semantic space x", x = "semantic space y");
p1 <- p1 + theme(legend.key = element_blank()) ;
one.x_range = max(one.data$plot_X) - min(one.data$plot_X);
one.y_range = max(one.data$plot_Y) - min(one.data$plot_Y);
p1 <- p1 + xlim(min(one.data$plot_X)-one.x_range/10,max(one.data$plot_X)+one.x_range/10);
p1 <- p1 + ylim(min(one.data$plot_Y)-one.y_range/10,max(one.data$plot_Y)+one.y_range/10);


# --------------------------------------------------------------------------
# Output the plot to screen

p1;

# Uncomment the line below to also save the plot to a file.
# The file type depends on the extension (default=pdf).

# ggsave("/path_to_your_file/revigo-plot.pdf");

